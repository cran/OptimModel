<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Steven Novick" />

<meta name="date" content="2025-05-04" />

<title>OptimModel Vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">OptimModel Vignette</h1>
<h4 class="author">Steven Novick</h4>
<h4 class="date">2025-05-04</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The R package OptimModel provides various nonlinear (or linear)
curve-fitting functions that use <code>stats::optim()</code> as its
base. The packages contains many commonly-used curves and also permits
the user to create a new curve function as well. To estimate curve
parameters, the user may call upon ordinary least squares (OLS),
weighted least squares (WLS), iterative reweighted least squares
(IRWLS), or maximum likelihood estimate (MLE). For WLS, the user
provides a fixed set of weights. For IRWLS and MLE, the user may choose
among a variety of weight functions. Finally, there is also a function
for robust outlier detection (ROUT), based on the work of Motulsky and
Brown (2006).</p>
</div>
<div id="pre-specified-models" class="section level1">
<h1>Pre-specified models</h1>
<p>In the OptimModel package, data are assumed to stem from the
model</p>
<p><span class="math display">\[ y_i = f(\boldsymbol{\theta}, x_i) +
e_i, i = 1, \ldots, n \]</span> where <span class="math inline">\(x_i\)</span> is a concentration or dose, <span class="math inline">\(y_i\)</span> is the response, <span class="math inline">\(\boldsymbol{\theta}\)</span> is a vector of
mean-model parameters, and <span class="math inline">\(e_i \sim N(0,
\sigma^2 g^2(\boldsymbol{\theta}, \boldsymbol{\phi}))\)</span>. The mean
of <span class="math inline">\(y_i | x_i\)</span> is <span class="math inline">\(f(\boldsymbol{\theta}, x_i)\)</span> and the
variance is <span class="math inline">\(\sigma^2
g^2(\boldsymbol{\theta}, \boldsymbol{\phi}))\)</span> with
variance-model parameters <span class="math inline">\(\boldsymbol{\phi}\)</span>. The default is <span class="math inline">\(g(\boldsymbol{\theta}, \boldsymbol{\phi}) =
1\)</span> so that <span class="math inline">\(e_i \sim N(0,
\sigma^2)\)</span>. The user, however, may instead provide non-negative
valued numerical weights <span class="math inline">\(\{w_1, \ldots, w_n
\}\)</span> so that <span class="math inline">\(e_i  \sim N(0, \sigma^2
\sqrt{w_i})\)</span>.</p>
<p>A number of pre-defined models for the mean and variance are provided
in OptimModel. User-defined mean models and/or variance models may be
supplied to the main function, optim_fit().</p>
<div id="mean-model-functions" class="section level2">
<h2>Mean-model functions</h2>
<p>Mean models are functions of the form <span class="math inline">\(f(\theta, x)\)</span>, where <span class="math inline">\(\theta\)</span> is a parameter vector and <span class="math inline">\(x\)</span> is an R object that is processed by the
function. Usually <span class="math inline">\(x\)</span> is a vector of
doses or concentrations; however, <span class="math inline">\(x\)</span>
may also be a matrix, data.frame, or list. Examples of user-defined mean
models are provided at the end of this section.</p>
<p>Although it is not a requirement, each of the mean-model functions
included in OptimModel is given several attributes, shown in the table
below, where f_model takes the place of the model function.</p>
<table>
<thead>
<tr class="header">
<th align="left">Attribute</th>
<th align="left">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">attr(f_model, ‘gradient’)</td>
<td align="left">Gradient of f_model with respect to theta</td>
</tr>
<tr class="even">
<td align="left">attr(f_model, ‘backsolve’)</td>
<td align="left">Find x such that f_model(theta, x) = y</td>
</tr>
<tr class="odd">
<td align="left">attr(f_model, ‘start’)</td>
<td align="left">Starting values for optimization</td>
</tr>
</tbody>
</table>
<p>If attr(f_model, ‘gradient’) is missing, the gradient of f_model will
be approximated. If attr(f_model, ‘start’) is missing, the user must
supply a starting value.</p>
<div id="exponential-decay-first-order" class="section level3">
<h3>Exponential decay (first order)</h3>
<p>The first-order exponential decay model is given by <span class="math display">\[f(\boldsymbol{\theta}, x) = A + B \times exp(-K
x),\]</span> where <span class="math inline">\(x\)</span> is the
concentration or dose, <span class="math inline">\(\boldsymbol{\theta} =
(A, B, lK)\)</span>, <span class="math inline">\(A\)</span> is the
minimum value, <span class="math inline">\(A+B\)</span> is the maximum
value, and <span class="math inline">\(K=exp(lK)\)</span> is the shape
parameter.</p>
</div>
</div>
<div id="exponential-decay-first-order-with-plateau" class="section level2">
<h2>Exponential decay (first order) with plateau</h2>
<p>The first-order exponential decay model with plateau is an extension
of the exponential decay model and given as <span class="math inline">\(f(\boldsymbol{\theta}, x) = y_{max}\)</span> if
<span class="math inline">\(x \le X_0\)</span> and <span class="math inline">\(f(\boldsymbol{\theta}, x) = y_{min} + (y_{max} -
y_{min}) \times exp(-K (x-X0))\)</span> if <span class="math inline">\(x
&gt; X_0\)</span>, where <span class="math inline">\(\boldsymbol{\theta}
= (x_0, y_{min}, y_{max}, lK)\)</span>, <span class="math inline">\(X_0=exp(x_0)\)</span> is the inflection point
between plateau and exponential decay curve, <span class="math inline">\(y_{min}\)</span> is the minimum value, <span class="math inline">\(y_{max}\)</span> is the maximum value, and <span class="math inline">\(K=exp(lK)\)</span> is the shape parameter.</p>
</div>
<div id="exponential-decay-second-order" class="section level2">
<h2>Exponential decay (second order)</h2>
<p>The second-order exponential decay model is given by <span class="math display">\[f(\boldsymbol{\theta}, x) = A + B \times \{  p
\times \exp(-K_1 x) + (1-p) \times \exp(-K_2 x) \},\]</span> where <span class="math inline">\(x\)</span> is the concentration or dose, <span class="math inline">\(\boldsymbol{\theta} = (A, B, lK_1, lK_2,
p)\)</span>, <span class="math inline">\(A\)</span> is the minimum
value, <span class="math inline">\(A+B\)</span> is the maximum value,
<span class="math inline">\(K_1=exp(lK_1)\)</span> and <span class="math inline">\(K_2 = exp(lK_2)\)</span> are shape parameters, and
<span class="math inline">\(p\)</span> is the proportion of signal from
the first exponential term.</p>
<div id="gompertz-model" class="section level3">
<h3>Gompertz model</h3>
<p>The four-parameter Gompertz model is a sigmoidal shaped curve, given
by</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = A + (B -
A)\times \exp( -\exp( m*(x- x_0)) ), \]</span> where <span class="math inline">\(x\)</span> is the concentration or dose, <span class="math inline">\(\boldsymbol{\theta} = (A, B, m, x_0)\)</span>,
<span class="math inline">\(A\)</span> is the minimum value, <span class="math inline">\(A + (B-A)\times exp(-exp(-m x_0 ))\)</span> is the
maximum value, <span class="math inline">\(m\)</span> is the shape
parameter, and <span class="math inline">\(x_0\)</span> is an offset
that shifts the curve on the <span class="math inline">\(x\)</span>-axis.</p>
</div>
<div id="four-parameter-hill-4pl-model" class="section level3">
<h3>Four-parameter Hill (4PL) model</h3>
<p>The Hill equation (Hill, 1910), which is equivalent to the
four-parameter logistic curve (Verhulst, 1845), is a sigmoidal-shaped
curve with meaningful parameters. The mean model is</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = e_{min} +
\frac{e_{max} - e_{min}}{ 1 + \exp( m \times( lec50 - log(x) ) )},
\]</span> where <span class="math inline">\(x\)</span> is the
concentration or dose, <span class="math inline">\(\boldsymbol{\theta}=(e_{min}, e_{max}, lec50,
m)\)</span>, <span class="math inline">\(e_{min}\)</span> is the minimum
asymptote, <span class="math inline">\(e_{max}\)</span> is the maximum
asymptote, <span class="math inline">\(lec50\)</span> is the natural log
EC50, and <span class="math inline">\(m\)</span> is the shape parameter.
Note that <span class="math inline">\(f(\boldsymbol{\theta}, EC50) =
\frac{1}{2}( e_{min} + e_{max})\)</span> and <span class="math inline">\(m\)</span> is often called the <em>slope</em> or
<em>Hill</em> parameter. Refer to Hill (1910) or Verhulst (1845) for
more information.</p>
</div>
<div id="five-parameter-hill-model" class="section level3">
<h3>Five-parameter Hill model</h3>
<p>The 5-parameter Hill equation is an extension of the 4-parameter
model that is asymmetric around the EC50. The model is given by</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = e_{min} +
\frac{e_{max} - e_{min}}{ \{1 + exp( m \times( lec50 - log(x) ) )\}^s},
\]</span> where <span class="math inline">\(x\)</span> is the
concentration or dose, <span class="math inline">\(\boldsymbol{\theta}=(e_{min}, e_{max}, lec50, m,
ls)\)</span>, <span class="math inline">\(e_{min}\)</span> is the
minimum asymptote, <span class="math inline">\(e_{max}\)</span> is the
maximum asymptote, <span class="math inline">\(lec50\)</span> is the
natural log EC50, <span class="math inline">\(m\)</span> is the shape
parameter, and <span class="math inline">\(s=exp(ls)\)</span> is the
symmetry parameter. Note that <span class="math inline">\(f(\boldsymbol{\theta}, EC50) = \frac{1}{2^s}(
e_{min} + e_{max})\)</span> and <span class="math inline">\(m\)</span>
is often called the <em>slope</em> or <em>Hill</em> parameter.</p>
</div>
<div id="hill-quadratic-model" class="section level3">
<h3>Hill quadratic model</h3>
<p>The Hill model with a quadratic term is a five-parameter equation for
biphasic data. The mean model is given by</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = e_{min} +
\frac{e_{max} - e_{min}}{ \{1 + exp( -\{a + b z + c z^2 \})}, \]</span>
where <span class="math inline">\(z=log(x)\)</span>, <span class="math inline">\(x\)</span> is the concentration or dose, <span class="math inline">\(\boldsymbol{\theta}=(e_{min}, e_{max}, a, b,
c)\)</span>, <span class="math inline">\(e_{min}\)</span> is the minimum
asymptote, <span class="math inline">\(e_{max}\)</span> is the maximum
asymptote, and <span class="math inline">\((a, b, c)\)</span> are
respectively the intercept, linear, and quadratic terms.</p>
<p>Note that if <span class="math inline">\(c = 0\)</span>, this model
is equivalent to the four-parameter Hill model (hill.model). Also, the
<span class="math inline">\(EC50\)</span> is defined where <span class="math inline">\(a + b z + c z^2 = 0\)</span>. If the roots of the
quadratic equation are real, then the <span class="math inline">\(EC50\)</span> is given by <span class="math inline">\((-b +/- \sqrt{b^2 - 4 a c})/(2 c)\)</span>. The
user decides which of the roots is meaningful.</p>
</div>
<div id="hill-switchpoint-model" class="section level3">
<h3>Hill switchpoint model</h3>
<p>The Hill switchpoint is a biphasic equation that extends the
four-parameter Hill model. The mean model is</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = e_{min} +
\frac{e_{max} - e_{min}}{ 1 + exp( m f(s, x) \times( lec50 - log(x) )
)}, \]</span> where <span class="math inline">\(x\)</span> is the
concentration or dose, <span class="math inline">\(\boldsymbol{\theta}=(e_{min}, e_{max}, lec50, m,
ls)\)</span>, <span class="math inline">\(e_{min}\)</span> is the
minimum asymptote, <span class="math inline">\(e_{max}\)</span> is the
maximum asymptote, <span class="math inline">\(lec50\)</span> is the
natural log EC50, and <span class="math inline">\(m\)</span> is the
shape parameter. Note that <span class="math inline">\(f(\boldsymbol{\theta}, EC50) = \frac{1}{2}(
e_{min} + e_{max})\)</span> and <span class="math inline">\(m\)</span>
is often called the <em>slope</em> or <em>Hill</em> parameter.</p>
</div>
<div id="beta-model" class="section level3">
<h3>Beta model</h3>
<p>The Beta model is a biphasic curve based on the Beta function. Found
in <code>MCPMod::betaMod()</code>, the curve is given by</p>
<p><span class="math display">\[ f(\boldsymbol{\theta}, x) = e_{min} +
e_{max} \times exp \left( log\{ \beta(\delta_1, \delta_2) \} +
    \delta_1 \times log(x) + \delta_2 \times log(sc - x) - (\delta_1 +
\delta_2) \times log(sc) \right),
\]</span> where <span class="math inline">\(\beta(\delta_1, \delta_2) =
(\delta_1+\delta_2)^{(\delta_1+\delta_2)} / ( \delta_1^{\delta_1} \times
\delta_2^{\delta^2} )\)</span>, <span class="math inline">\(e_{min}\)</span> is a lower aymptote, <span class="math inline">\(e_{max}\)</span> is an upper asymptote, <span class="math inline">\(sc\)</span> is a scaling parameter, and <span class="math inline">\(\delta_1\)</span> and <span class="math inline">\(\delta_2\)</span> are power parameters.</p>
</div>
<div id="user-defined-mean-model" class="section level3">
<h3>User defined mean model</h3>
<p>An example of a user-defined mean model is from simple linear
regression. Code is provided below in which theta = c( intercept, slope
) and <span class="math inline">\(x\)</span> is a vector.</p>
<pre><code>slr_model = function(theta, x){  theta[1] + theta[2]*x }

theta = c( 2, -5 )   ## Intercept, slope
x = seq(1, 10, by=0.5)
slr_model(theta, x)
</code></pre>
<p>The next example shows <span class="math inline">\(x\)</span> as a
matrix for multivariate linear regression.</p>
<pre><code>mlr_model = function(theta, x){  theta[1] + theta[2]*x[,1] + theta[3]*x[,2] }

theta = c( 2, -5, 0.1 )   ## Intercept, slope1, slope2
x1 = seq(1, 10, by=0.5)
x2 = seq(10, 1, by=-0.5)
mlr_model(theta, x=cbind(x1, x2))
</code></pre>
</div>
</div>
<div id="weightvariance-functions" class="section level2">
<h2>Weight/Variance functions</h2>
<p>The package OptimModel also provides several pre-defined
weight/variance functions. The default function is weights_varIdent(),
which sets <span class="math inline">\(g(\boldsymbol{\theta},
\boldsymbol{\phi}) = 1\)</span> for all observations (i.e., no weights).
The user has no reason to call weights_varIdent().</p>
<p>The following table shows the forms of <span class="math inline">\(g(\boldsymbol{\theta}, \boldsymbol{\phi})\)</span>
for pre-defined functions, where <span class="math inline">\(mu =
f(\boldsymbol{\theta}, x)\)</span> and <span class="math inline">\(resid
= y - mu\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th align="left">Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">weights_varIdent(phi, mu)</td>
<td align="left">rep(1, length(mu))</td>
</tr>
<tr class="even">
<td align="left">weights_varExp(phi, mu)</td>
<td align="left">exp(phi*mu)</td>
</tr>
<tr class="odd">
<td align="left">weights_varPower(phi, mu)</td>
<td align="left">abs(mu)^(phi)</td>
</tr>
<tr class="even">
<td align="left">weights_varConstPower(phi, mu)</td>
<td align="left">phi[1]+abs(mu)^(phi[2])</td>
</tr>
<tr class="odd">
<td align="left">weights_tukey_bw(phi=4.685, resid)</td>
<td align="left">see below</td>
</tr>
<tr class="even">
<td align="left">weights_huber(phi=1.345, resid)</td>
<td align="left">see below</td>
</tr>
</tbody>
</table>
<div id="tukey-bi-weight" class="section level3">
<h3>Tukey bi-weight</h3>
<p>The weight function is <span class="math inline">\(w =
(1-(r/\phi)^2)^2\)</span> if <span class="math inline">\(r \le
\phi\)</span> and <span class="math inline">\(w=0\)</span> otherwise,
where <span class="math inline">\(r = |resid|/sig\)</span> and sig =
mad(resid, center=0). Traditionally, <span class="math inline">\(phi =
4.685\)</span>.</p>
</div>
<div id="huber-weights" class="section level3">
<h3>Huber weights</h3>
<p>The weight function is <span class="math inline">\(w = min(1, \phi /
r)\)</span>, where <span class="math inline">\(r = |resid|/sig\)</span>
and sig = mad(resid, center=0). Traditionally, <span class="math inline">\(phi = 1.345\)</span>. This is also the default
weight used in <code>MASS::rlm()</code>.</p>
</div>
<div id="user-defined-weights" class="section level3">
<h3>User-defined weights</h3>
<p>The user may provide a weight function with arguments <em>phi</em>
and <em>mu</em>. For example,</p>
<pre><code>weights_user1 = function(phi, mu){  ifelse( mu &lt; 5, (1/mu), (1/mu)^phi ) }

mu = 1:10
phi = 2.4
weights_user1(phi, mu)</code></pre>
</div>
</div>
<div id="calling-optim_fit" class="section level2">
<h2>Calling optim_fit</h2>
<p>Usage of the optim_fit() function will be illustrated with a data set
generated from the hill_model(). An optim_fit() object is associated
with S3-type functionality for <em>print</em>, <em>fitted</em>, and
<em>residuals</em>.</p>
<div id="ols-and-wls" class="section level3">
<h3>OLS and WLS</h3>
<p>Data are generated from hill_model(). For OLS and WLS, the call to
optim_fit() is bare boned. The print.optim_fit() function provides
parameter estimates, standard errors, and 95% confidence intervals. It
also provides the rMSE (sigma), an <span class="math inline">\(r^2\)</span> value, and BIC value.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(OptimModel)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)), <span class="at">each=</span><span class="dv">4</span> )</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">log</span>(.<span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="dv">2</span> )</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="do">## No need to include a starting value.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;       par     standard.error lower   upper   </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; emin  -0.0458 0.5974         -1.2574   1.1658</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; emax  99.2786 0.6993         97.8603 100.6969</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; lec50 -0.6503 0.0184         -0.6877  -0.6130</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; m      2.1594 0.0774          2.0024   2.3165</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; sigma = 2.0426 on 36 degrees of freedom </span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9979 </span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; BIC =  184.8841   (smaller is better)</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="do">## Coefficients</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt;        emin        emax       lec50           m </span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; -0.04582586 99.27856807 -0.65033795  2.15943681</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="do">## Fitted values</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="fu">fitted</span>(fit)</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt;  [1] 99.27856807 99.27856807 99.27856807 99.27856807 98.27320258 98.27320258</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt;  [7] 98.27320258 98.27320258 94.93948372 94.93948372 94.93948372 94.93948372</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; [13] 82.44415089 82.44415089 82.44415089 82.44415089 51.91021938 51.91021938</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt; [19] 51.91021938 51.91021938 19.53345242 19.53345242 19.53345242 19.53345242</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; [25]  5.12854738  5.12854738  5.12854738  5.12854738  1.16123128  1.16123128</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt; [31]  1.16123128  1.16123128  0.22693902  0.22693902  0.22693902  0.22693902</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; [37]  0.01536124  0.01536124  0.01536124  0.01536124</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="do">## Residuals</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="fu">residuals</span>(fit)</span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co">#&gt;  [1] -1.965610882  1.964983041  2.323181264 -2.056352891 -1.240377833</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="co">#&gt;  [6] -0.459786220  1.569621876  0.689431687  1.192867878  0.324632706</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="co">#&gt; [11] -2.653457701  1.800358234 -0.466698260  0.863706482 -5.325761356</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="co">#&gt; [16]  1.450561979  1.563652969 -1.135252733  2.649848560  1.165547240</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="co">#&gt; [21] -0.482660037 -2.968070025 -2.387113040  0.883019419  0.682133203</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="co">#&gt; [26]  3.022374689 -0.171904379  0.097037498  3.346309206 -1.801525553</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="co">#&gt; [31] -0.680358172 -0.810355452 -3.835665264  0.754472293  0.503416542</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="co">#&gt; [36]  3.793470677 -1.239006478 -0.198304151 -0.765758483  0.004728182</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;label&quot;)</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Residuals&quot;</span></span></code></pre></div>
<p>The predict() function may be used to obtain mean-model estimates at
specific <em>x</em> values. It may also provide standard errors,
confidence intervals, and prediction intervals. A graph of the data with
95% confidence bands is provided.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt;      x     y.hat</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; [1,] 2 5.1285474</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; [2,] 3 2.1775014</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; [3,] 4 1.1612313</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; [4,] 5 0.7031703</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">se.fit=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;      x     y.hat    se.fit</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; [1,] 2 5.1285474 0.5130136</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; [2,] 3 2.1775014 0.4853637</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; [3,] 4 1.1612313 0.5104829</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; [4,] 5 0.7031703 0.5326739</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## 95% confidence interval</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt;      x     y.hat    se.fit      lower    upper</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; [1,] 2 5.1285474 0.5130136  4.0881076 6.168987</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; [2,] 3 2.1775014 0.4853637  1.1931383 3.161864</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; [3,] 4 1.1612313 0.5104829  0.1259241 2.196538</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; [4,] 5 0.7031703 0.5326739 -0.3771424 1.783483</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="do">## 90% confidence interval</span></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">level=</span><span class="fl">0.9</span>)</span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="co">#&gt;      x     y.hat    se.fit      lower    upper</span></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#&gt; [1,] 2 5.1285474 0.5130136  4.2624277 5.994667</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="co">#&gt; [2,] 3 2.1775014 0.4853637  1.3580630 2.996940</span></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="co">#&gt; [3,] 4 1.1612313 0.5104829  0.2993843 2.023078</span></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co">#&gt; [4,] 5 0.7031703 0.5326739 -0.1961418 1.602482</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="do">## 95% prediciton interval for next observation (K=1)</span></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>, <span class="at">K=</span><span class="dv">1</span>)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a><span class="co">#&gt;      x     y.hat    se.fit      lower    upper</span></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="co">#&gt; [1,] 2 5.1285474 0.5130136  0.8572438 9.399851</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#&gt; [2,] 3 2.1775014 0.4853637 -2.0804899 6.435493</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="co">#&gt; [3,] 4 1.1612313 0.5104829 -3.1088250 5.431288</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co">#&gt; [4,] 5 0.7031703 0.5326739 -3.5780205 4.984361</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a></span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;OLS&quot;</span>)</span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="do">## Fixed weights.  In this example, weights are increasing step-wise with x</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>w <span class="ot">=</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="do">## No need to include a starting value.</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">wts=</span>w)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; Weights = user.defined </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt;       par     standard.error lower   upper   </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; emin  -0.0430 0.5042         -1.0655   0.9796</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; emax  99.3303 1.0216         97.2584 101.4022</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; lec50 -0.6496 0.0220         -0.6942  -0.6049</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; m      2.1396 0.0862          1.9648   2.3145</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; sigma = 2.333 on 36 degrees of freedom </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9978 </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; BIC =  189.9727   (smaller is better)</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;WLS&quot;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="mle" class="section level3">
<h3>MLE</h3>
<p>The same curve may be fitted to the data via maximum likelihood. In
the following code output, note that the starting value needs to include
log of the standard deviation (‘lsigma’) as the last parameter.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fit.method=</span><span class="st">&quot;mle&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;mle&#39;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;        par     standard.error lower   upper   </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; emin   -0.0458 0.5668         -1.1566   1.0651</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; emax   99.2788 0.6634         97.9785 100.5791</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; lec50  -0.6503 0.0175         -0.6846  -0.6161</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; m       2.1594 0.0735          2.0155   2.3034</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; lsigma  0.6616 0.1118          0.4424   0.8807</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; sigma = 1.9378 on Inf degrees of freedom </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9979 </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; BIC =  188.573   (smaller is better)</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; var/weight param(s):</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; [1] none</span></span></code></pre></div>
<p>Maximum likelihood can also be used with variance model functions.
The following code illustrates the method with a power-of-the-mean
variance model (weights_varPower) with <span class="math inline">\(\sigma=0.7\)</span> and <span class="math inline">\(\phi = 0.5\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">876</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="do">## Standard deviation = sigma*( Mean )^0.5</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">hill_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="fl">0.7</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">hill_model</span>(theta, x)) )</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y2, <span class="at">wts=</span>weights_varPower,</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>                <span class="at">fit.method=</span><span class="st">&quot;mle&quot;</span>, <span class="at">phi.fixed=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;mle&#39;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varPower </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;        par      standard.error lower   upper   </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; emin    -0.3626 0.1237         -0.6050  -0.1202</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; emax   102.9510 1.7656         99.4906 106.4114</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; lec50   -0.7299 0.0383         -0.8049  -0.6549</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; m        1.8806 0.0775          1.7286   2.0326</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; v1       0.4190 0.0426          0.3355   0.5024</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; lsigma  -0.2895 0.1543         -0.5919   0.0128</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; sigma = 0.7486 on Inf degrees of freedom </span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9997 </span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; BIC =  196.694   (smaller is better)</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; var/weight param(s):</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt;   phi </span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; 0.419</span></span></code></pre></div>
</div>
<div id="irwls" class="section level3">
<h3>IRWLS</h3>
<p>The same variance model may be fitted to the data using iterative
reweighted least squares.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y2, <span class="at">wts=</span>weights_varPower,</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                <span class="at">fit.method=</span><span class="st">&quot;irwls&quot;</span>, <span class="at">phi.fixed=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; Warning in nlm(.trkfunc, phi.start, hessian = FALSE, typsize = rep(1,</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; length(phi)), : Inf replaced by maximum positive value</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;irwls&#39;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varPower </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt;       par      standard.error lower   upper   </span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; emin    0.0502 0.1314         -0.2162   0.3166</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; emax  102.4983 1.8791         98.6872 106.3094</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; lec50  -0.7251 0.0401         -0.8065  -0.6437</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; m       1.9330 0.0773          1.7763   2.0897</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; sigma = 0.6392 on 36 degrees of freedom </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9998 </span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; BIC =  186.3115   (smaller is better)</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; var/weight param(s):</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;    phi </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 0.4714</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y2)</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="robust-model-fit" class="section level3">
<h3>Robust model fit</h3>
<p>Iterative reweighted least squares may be implemented with a robust
weighting scheme, such as Huber weighting, to down-weight outliers. With
OLS, the curve gets pulled slightly downward by the outliers, but with
the Huber weighting, the outliers are virtually ignored.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)), <span class="at">each=</span><span class="dv">4</span> )</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">log</span>(.<span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="dv">2</span> )</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">## Create outliers</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>y[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>)] <span class="ot">=</span> y[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>)] <span class="sc">+</span> <span class="sc">-</span><span class="dv">30</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="do">## Ordinary least squares</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;OLS fit&quot;</span>)</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">## IRWLS with Huber weights</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">wts=</span>weights_huber,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                <span class="at">fit.method=</span><span class="st">&quot;irwls&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;IRWLS + Huber weights fit&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="multiple-starting-values" class="section level3">
<h3>Multiple starting values</h3>
<p>As a convenience, optim_fit() can be called upon to try starting
values in a neighborhood of the original starting value (either
user-supplied <em>theta0</em> or the attr(f_model, ‘start’) value). The
following code illustrates its usage. The model is initially fitted with
OLS and a singular starting value. Although the fitted object claims
that convergence is achieved, the <span class="math inline">\(r^2=0.50\)</span> value is contradictory. When a
grid of neighboring starting value is tried, one of them achieves a much
lower BIC. A graph of the model fit is shown with a single starting
value (red) and the fixed (green) and random (blue) neighborhoods of
starting values. Note that the green and blue curves overlap.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">log</span>(<span class="fl">0.25</span>), <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill_switchpoint_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">5</span> )</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="do">## Try OLS, but original starting value does not provide convergence</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>fit1 <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="cn">NULL</span>, hill_switchpoint_model, <span class="at">x=</span>x, <span class="at">y=</span>y) </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">print</span>(fit1)</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;      par     standard.error lower      upper    </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; emin  0.6472    3.3471         -6.1478    7.4421</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; emax 30.2027    3.7421         22.6058   37.7995</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; ec50 12.1289 1125.6173      -2272.9957 2297.2536</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; m     3.1558  270.7225       -546.4402  552.7517</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; lsp  -0.6482    1.4261         -3.5434    2.2469</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; sigma = 14.9684 on 35 degrees of freedom </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.5047 </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; BIC =  346.7826   (smaller is better)</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="do">## Fixed grid of equally-spaced starting values</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>fit2 <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="cn">NULL</span>, hill_switchpoint_model, <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">ntry=</span><span class="dv">50</span>, </span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>       <span class="at">start.method=</span><span class="st">&quot;fixed&quot;</span>, <span class="at">until.converge=</span><span class="cn">FALSE</span>)</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 1.00216e-116</span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 7.17357e-17</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 1.86509e-36</span></span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a><span class="fu">print</span>(fit2)</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb12-58"><a href="#cb12-58" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb12-59"><a href="#cb12-59" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-60"><a href="#cb12-60" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb12-61"><a href="#cb12-61" tabindex="-1"></a><span class="co">#&gt;      par      standard.error lower     upper   </span></span>
<span id="cb12-62"><a href="#cb12-62" tabindex="-1"></a><span class="co">#&gt; emin   0.7125   0.9154         -1.1458   2.5709</span></span>
<span id="cb12-63"><a href="#cb12-63" tabindex="-1"></a><span class="co">#&gt; emax  50.3381   1.5857         47.1191  53.5572</span></span>
<span id="cb12-64"><a href="#cb12-64" tabindex="-1"></a><span class="co">#&gt; ec50  -0.7070   0.0928         -0.8954  -0.5187</span></span>
<span id="cb12-65"><a href="#cb12-65" tabindex="-1"></a><span class="co">#&gt; m    -28.8584 191.3471       -417.3136 359.5968</span></span>
<span id="cb12-66"><a href="#cb12-66" tabindex="-1"></a><span class="co">#&gt; lsp   -2.7548   0.1192         -2.9967  -2.5128</span></span>
<span id="cb12-67"><a href="#cb12-67" tabindex="-1"></a><span class="co">#&gt; sigma = 4.4844 on 35 degrees of freedom </span></span>
<span id="cb12-68"><a href="#cb12-68" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9555 </span></span>
<span id="cb12-69"><a href="#cb12-69" tabindex="-1"></a><span class="co">#&gt; BIC =  250.3562   (smaller is better)</span></span>
<span id="cb12-70"><a href="#cb12-70" tabindex="-1"></a></span>
<span id="cb12-71"><a href="#cb12-71" tabindex="-1"></a><span class="do">## Random grid of starting values</span></span>
<span id="cb12-72"><a href="#cb12-72" tabindex="-1"></a>fit3 <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="cn">NULL</span>, hill_switchpoint_model, <span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">ntry=</span><span class="dv">50</span>, </span>
<span id="cb12-73"><a href="#cb12-73" tabindex="-1"></a>       <span class="at">start.method=</span><span class="st">&quot;fixed&quot;</span>, <span class="at">until.converge=</span><span class="cn">FALSE</span>)</span>
<span id="cb12-74"><a href="#cb12-74" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-75"><a href="#cb12-75" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-76"><a href="#cb12-76" tabindex="-1"></a><span class="co">#&gt; Warning in sqrt(diag(fit$varBeta)): NaNs produced</span></span>
<span id="cb12-77"><a href="#cb12-77" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-78"><a href="#cb12-78" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 1.00216e-116</span></span>
<span id="cb12-79"><a href="#cb12-79" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-80"><a href="#cb12-80" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-81"><a href="#cb12-81" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-82"><a href="#cb12-82" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-83"><a href="#cb12-83" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-84"><a href="#cb12-84" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-85"><a href="#cb12-85" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-86"><a href="#cb12-86" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 7.17357e-17</span></span>
<span id="cb12-87"><a href="#cb12-87" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-88"><a href="#cb12-88" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-89"><a href="#cb12-89" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-90"><a href="#cb12-90" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-91"><a href="#cb12-91" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-92"><a href="#cb12-92" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): NaNs produced</span></span>
<span id="cb12-93"><a href="#cb12-93" tabindex="-1"></a><span class="co">#&gt; Error in solve.default(0.5 * fit$hessian) : </span></span>
<span id="cb12-94"><a href="#cb12-94" tabindex="-1"></a><span class="co">#&gt;   system is computationally singular: reciprocal condition number = 1.86509e-36</span></span>
<span id="cb12-95"><a href="#cb12-95" tabindex="-1"></a><span class="co">#&gt; Warning in .get.fit.stats(fit[[i]], x, y, conf.level): Invalid</span></span>
<span id="cb12-96"><a href="#cb12-96" tabindex="-1"></a><span class="co">#&gt; variance-covariance matrix.</span></span>
<span id="cb12-97"><a href="#cb12-97" tabindex="-1"></a><span class="fu">print</span>(fit3)</span>
<span id="cb12-98"><a href="#cb12-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-99"><a href="#cb12-99" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb12-100"><a href="#cb12-100" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb12-101"><a href="#cb12-101" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb12-102"><a href="#cb12-102" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb12-103"><a href="#cb12-103" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-104"><a href="#cb12-104" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb12-105"><a href="#cb12-105" tabindex="-1"></a><span class="co">#&gt;      par      standard.error lower     upper   </span></span>
<span id="cb12-106"><a href="#cb12-106" tabindex="-1"></a><span class="co">#&gt; emin   0.7125   0.9154         -1.1458   2.5709</span></span>
<span id="cb12-107"><a href="#cb12-107" tabindex="-1"></a><span class="co">#&gt; emax  50.3381   1.5857         47.1191  53.5572</span></span>
<span id="cb12-108"><a href="#cb12-108" tabindex="-1"></a><span class="co">#&gt; ec50  -0.7070   0.0928         -0.8954  -0.5187</span></span>
<span id="cb12-109"><a href="#cb12-109" tabindex="-1"></a><span class="co">#&gt; m    -28.8584 191.3471       -417.3136 359.5968</span></span>
<span id="cb12-110"><a href="#cb12-110" tabindex="-1"></a><span class="co">#&gt; lsp   -2.7548   0.1192         -2.9967  -2.5128</span></span>
<span id="cb12-111"><a href="#cb12-111" tabindex="-1"></a><span class="co">#&gt; sigma = 4.4844 on 35 degrees of freedom </span></span>
<span id="cb12-112"><a href="#cb12-112" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9555 </span></span>
<span id="cb12-113"><a href="#cb12-113" tabindex="-1"></a><span class="co">#&gt; BIC =  250.3562   (smaller is better)</span></span>
<span id="cb12-114"><a href="#cb12-114" tabindex="-1"></a></span>
<span id="cb12-115"><a href="#cb12-115" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb12-116"><a href="#cb12-116" tabindex="-1"></a>x.seq <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>)</span>
<span id="cb12-117"><a href="#cb12-117" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">rep</span>(x.seq, <span class="dv">3</span>),</span>
<span id="cb12-118"><a href="#cb12-118" tabindex="-1"></a>                  <span class="at">Fit=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;1 starting value&quot;</span>, <span class="st">&quot;Fixed grid&quot;</span>, <span class="st">&quot;Random grid&quot;</span>), <span class="at">each=</span><span class="dv">25</span>),</span>
<span id="cb12-119"><a href="#cb12-119" tabindex="-1"></a>                  <span class="at">mu=</span><span class="fu">c</span>(<span class="fu">predict</span>(fit1, <span class="at">x=</span>x.seq)[,<span class="st">&quot;y.hat&quot;</span>],</span>
<span id="cb12-120"><a href="#cb12-120" tabindex="-1"></a>                       <span class="fu">predict</span>(fit2, <span class="at">x=</span>x.seq)[,<span class="st">&quot;y.hat&quot;</span>],</span>
<span id="cb12-121"><a href="#cb12-121" tabindex="-1"></a>                       <span class="fu">predict</span>(fit3, <span class="at">x=</span>x.seq)[,<span class="st">&quot;y.hat&quot;</span>])</span>
<span id="cb12-122"><a href="#cb12-122" tabindex="-1"></a>                )</span>
<span id="cb12-123"><a href="#cb12-123" tabindex="-1"></a></span>
<span id="cb12-124"><a href="#cb12-124" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb12-125"><a href="#cb12-125" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, mu, <span class="at">col=</span>Fit)) <span class="sc">+</span></span>
<span id="cb12-126"><a href="#cb12-126" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;top&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-127"><a href="#cb12-127" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col=</span><span class="fu">guide_legend</span>(<span class="at">ncol=</span><span class="dv">2</span>))</span>
<span id="cb12-128"><a href="#cb12-128" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="user-defined-model" class="section level3">
<h3>User-defined model</h3>
<p>To illustrate a simple user-defined model, a three-parameter Hill
model is constructed with <span class="math inline">\(e_{max}=100\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)), <span class="at">each=</span><span class="dv">4</span> )</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">log</span>(.<span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>hill3_model <span class="ot">=</span> <span class="cf">function</span>(theta, x){ </span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="do">## Parameters are theta = (emin, lec50, m).  Assumes emax = 100.</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  mu <span class="ot">=</span> theta[<span class="dv">1</span>] <span class="sc">+</span> (<span class="dv">100</span> <span class="sc">-</span> theta[<span class="dv">1</span>])<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(theta[<span class="dv">3</span>]<span class="sc">*</span><span class="fu">log</span>(x) <span class="sc">-</span> theta[<span class="dv">3</span>]<span class="sc">*</span>theta[<span class="dv">2</span>]))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  <span class="fu">return</span>(mu)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  }</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill3_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="dv">2</span> )</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="fu">c</span>(<span class="at">emin=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">lec50=</span><span class="fu">log</span>(<span class="fl">0.5</span>), <span class="at">m=</span><span class="dv">1</span>), <span class="at">f.model=</span>hill3_model, <span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">print</span>(fit)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt; Fit method = &#39;ols&#39;</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; Variance computation method = &#39;hessian&#39;</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; Weights = weights_varIdent </span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; 95% Wald CI for parameters</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt;       par     standard.error lower   upper  </span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; emin  -0.1492 0.5925         -1.3496  1.0513</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; lec50 -0.6590 0.0165         -0.6924 -0.6257</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; m      2.1188 0.0646          1.9878  2.2498</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; sigma = 2.0441 on 37 degrees of freedom </span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; r-squared = 0.9978 </span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; BIC =  182.3478   (smaller is better)</span></span></code></pre></div>
</div>
<div id="functions-of-parameters" class="section level3">
<h3>Functions of parameters</h3>
<p>As a convenience function, the standard error (using the
<em>delta</em> method) and confidence interval for a function of model
parameters may be obtained with get_se_func() as demonstrated below. The
hill_model parameters are <span class="math inline">\((e_{min}, e_{max},
lec50, m)\)</span> and the function of interest is <span class="math inline">\(lec50 + (1/m) log( \frac{0.5 e_{max}}{ 0.5 e_{max}
- e_{min}} )\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)), <span class="at">each=</span><span class="dv">4</span> )</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">log</span>(.<span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="dv">2</span> )</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>myfunc <span class="ot">=</span> <span class="cf">function</span>(theta){ theta[<span class="dv">3</span>] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>theta[<span class="dv">4</span>])<span class="sc">*</span><span class="fu">log</span>( <span class="fl">0.5</span><span class="sc">*</span>theta[<span class="dv">2</span>]<span class="sc">/</span>(<span class="fl">0.5</span><span class="sc">*</span>theta[<span class="dv">2</span>] <span class="sc">-</span> theta[<span class="dv">1</span>])) }</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">myfunc</span>( <span class="fu">coef</span>(fit) )</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;      lec50 </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; -0.6507653</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="fu">get_se_func</span>(<span class="at">object=</span>fit, <span class="at">Func=</span>myfunc) </span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;              est         SE     lower      upper</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; lec50 -0.6507653 0.01722887 -0.685707 -0.6158235</span></span></code></pre></div>
</div>
</div>
<div id="detecting-outliers-with-rout" class="section level2">
<h2>Detecting outliers with ROUT</h2>
<p>Instead of down-weighting outliers, sometimes it is more desirable to
detect and eliminate them. The Robust Outlier (ROUT) detection method of
Motulsky and Brown (2008) has been implemented in the OptimModel
package. The Huber weights data example is repeated, but with the
rout_fitter().</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rep</span>( <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>)), <span class="at">each=</span><span class="dv">4</span> )</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fu">log</span>(.<span class="dv">5</span>), <span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">hill_model</span>(theta, x) <span class="sc">+</span> <span class="fu">rnorm</span>( <span class="fu">length</span>(x), <span class="at">sd=</span><span class="dv">2</span> )</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="do">## Create outliers</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>y[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>)] <span class="ot">=</span> y[<span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">11</span>)] <span class="sc">+</span> <span class="sc">-</span><span class="dv">30</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="do">## ROUT</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>fit_r <span class="ot">=</span> <span class="fu">rout_fitter</span>(<span class="at">theta0=</span><span class="cn">NULL</span>, <span class="at">f.model=</span>hill_model, <span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">print</span>(fit_r)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; ROUT Fitted Model Statistics </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Convergence : Achieved </span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; Parameter estimates</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt;        emin        emax       lec50           m lsig.68.27% </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt;     -0.2608     99.3133     -0.6281      2.2006      0.0731 </span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; RSDR = 2.1934 from 40 obsevations and 4 parameter(s) </span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; r-sq (without FDR correction) = 0.9983 </span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; r-sq (with FDR correction) = 0.9977 </span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; Q = 0.01 </span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; # of outliers detected (without FDR correction) = 3 </span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt; # of outliers detected (with FDR correction) = 2</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="do">## Get the outliers and remove them</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">which</span>(fit_r<span class="sc">$</span>outlier.adj))</span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; [1]  8 11</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>index <span class="ot">=</span> <span class="sc">!</span>fit_r<span class="sc">$</span>outlier.adj</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>x.clean <span class="ot">=</span> x[index]</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>y.clean <span class="ot">=</span> y[index]</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="do">## Refit model with OLS, but outliers removed</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim_fit</span>(<span class="cn">NULL</span>, hill_model, <span class="at">x=</span>x.clean, <span class="at">y=</span>y.clean)</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)</span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(fit, <span class="at">x=</span><span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">4</span>, <span class="at">length=</span><span class="dv">25</span>), <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="fu">ggplot</span>( d, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(x, y.hat)) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>( <span class="at">data=</span>pred, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y.hat, <span class="at">ymin=</span>lower, <span class="at">ymax=</span>upper), <span class="at">alpha=</span><span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;OLS fit after ROUT&quot;</span>)</span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">#&gt; Warning in scale_x_log10(): log-10 transformation introduced infinite values.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The OptimModel package provides a wide variety of curve-fitting
options. From an optim_fit() object, the user may obtain a printed
summary of the model fit, residuals, predicted values with standard
error, confidence intervals, and prediction intervals. The standard
error and confidence intervals may also be obtained for functions of the
model parameters. The user may opt to fit the model with OLS, MLE, or
IRWLS. The ROUT outlier detection method is also available.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ol style="list-style-type: decimal">
<li><p>Motulsky, H.J. and Brown, R.E. (2006) Detecting Outliers When
Fitting Data with Nonlinear Regression: A New Method Based on Robust
Nonlinear Regression and the False Discovery Rate. BMC Bioinformatics,
7, 123.</p></li>
<li><p>Hill AV. (1910) The possible effects of the aggregation of the
molecules of haemoglobin on its dissociation curves. J Physiol (Lond.)
40:iv–vii.</p></li>
</ol>
<p>3 Verhulst, Pierre-François (1845). “Recherches mathématiques sur la
loi d’accroissement de la population” [Mathematical Researches into the
Law of Population Growth Increase]. Nouveaux Mémoires de l’Académie
Royale des Sciences et Belles-Lettres de Bruxelles. 18: 8. Retrieved 18
February 2013. Nous donnerons le nom de logistique à la courbe [We will
give the name logistic to the curve]</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
